https://stackoverflow.com/questions/18550127/how-to-do-virtual-file-processing